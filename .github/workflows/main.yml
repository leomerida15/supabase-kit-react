name: CI

on: [push]

jobs:
    build:
        name: Build, lint, and test on ${{ matrix.os }}

        runs-on: ${{ matrix.os }}
        strategy:
            matrix:
                os: [ubuntu-latest]

        steps:
            - name: â‡ï¸ Checkout repo
              uses: actions/checkout@v4

            - name: Set up Bun
              uses: oven-sh/setup-bun@v1
              with:
                  bun-version: latest

            - name: ğŸ“¥ Install dependencies with Bun (with cache)
              run: bun install

            - name: ğŸ’… Lint
              run: bun lint

            # - name: ğŸ§ª Test
            #   run: bun test --ci --coverage --max-workers=2

            - name: ğŸ› ï¸ Build
              run: bun run build

            - name: ğŸš€ Publish to npm
              uses: JS-DevTools/npm-publish@v1
              with:
                  token: ${{ secrets.NPM_TOKEN }}
